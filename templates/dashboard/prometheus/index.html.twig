{% extends '@EasyAdmin/page/content.html.twig' %}
{% block title %}Prometheus Dashboard{% endblock %}

{% block content_title %}{% endblock %}

{% block content_top_header %}
    <div class="d-flex align-items-center gap-2">
        <h5 class="m-0">
            <i class="fas fa-database"></i>
            Prometheus Dashboard
        </h5>
    </div>
    {{ parent() }}
{% endblock %}

{% block head_stylesheets %}
    {{ parent() }}
    <style>
        .content-wrapper {
            height: calc(100vh - 60px);
            padding: 0;
            margin: 0;
        }

        .prometheus-container {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        #main {
            padding: 0 !important;
        }

        .content-panel {
            padding: 0 !important;
            height: 100%;
        }
    </style>
{% endblock %}

{% block main %}
    <div class="prometheus-container-wrapper" style="height: calc(100vh - 120px); width: 100%;">
        <iframe
            id="prometheus-iframe"
            src="{{ prometheus_url }}"
            class="prometheus-container"
            allowfullscreen>
        </iframe>
    </div>
{% endblock %}

{% block body_javascript %}
    {{ parent() }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const iframe = document.getElementById('prometheus-iframe');

            function adjustIframeHeight() {
                const viewportHeight = window.innerHeight;
                const headerHeight = document.querySelector('.content-top')?.offsetHeight || 0;
                const newHeight = viewportHeight - headerHeight - 120;
                iframe.parentElement.style.height = newHeight + 'px';
            }

            window.addEventListener('resize', adjustIframeHeight);
            adjustIframeHeight();
        });
    </script>
{% endblock %}
